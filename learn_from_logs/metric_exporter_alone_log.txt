I0611 06:09:24.774878       1 metrics_exporter.go:90] Starting metrics exporter. Version:0.23.5 GitSHA:078df79 BuiltAt:2024-04-11T23:32:17
I0611 06:09:24.775144       1 config_manager.go:372] Parameters num: 11
I0611 06:09:24.775152       1 config_manager.go:374] OPERATOR_CONTAINER_CPU_LIMIT=10
I0611 06:09:24.775155       1 config_manager.go:374] OPERATOR_CONTAINER_CPU_REQUEST=0
I0611 06:09:24.775157       1 config_manager.go:374] OPERATOR_CONTAINER_MEM_LIMIT=10146668544
I0611 06:09:24.775158       1 config_manager.go:374] OPERATOR_CONTAINER_MEM_REQUEST=0
I0611 06:09:24.775160       1 config_manager.go:374] OPERATOR_POD_IP=10.244.0.17
I0611 06:09:24.775164       1 config_manager.go:374] OPERATOR_POD_NAME=clickhouse-operator-69f675cf8f-86j5s
I0611 06:09:24.775167       1 config_manager.go:374] OPERATOR_POD_NAMESPACE=test
I0611 06:09:24.775168       1 config_manager.go:374] OPERATOR_POD_NODE_NAME=local-control-plane
I0611 06:09:24.775170       1 config_manager.go:374] OPERATOR_POD_SERVICE_ACCOUNT=clickhouse-operator
I0611 06:09:24.775171       1 config_manager.go:374] WATCH_NAMESPACE=
I0611 06:09:24.775173       1 config_manager.go:374] WATCH_NAMESPACES=
I0611 06:09:24.775710       1 config_manager.go:91] File-based CHOP config:
I0611 06:09:24.775955       1 config_manager.go:92] 
runtime:
    configFilePath: /etc/clickhouse-operator/config.yaml
    configFolderPath: /etc/clickhouse-operator
    configCRNamespace: ""
    configCRName: ""
    configCRSources: []
    namespace: ""
watch:
    namespaces: []
clickhouse:
    configuration:
        file:
            path:
                common: config.d
                host: conf.d
                user: users.d
        user:
            default:
                profile: default
                quota: default
                networksIP:
                    - ::1
                    - 127.0.0.1
                password: '***'
        network:
            hostRegexpTemplate: (chi-{chi}-[^.]+\d+-\d+|clickhouse\-{chi})\.{namespace}\.svc\.cluster\.local$
    configurationRestartPolicy:
        rules:
            - version: '*'
              rules:
                - settings/*: "yes"
                - settings/access_control_path: "no"
                - settings/dictionaries_config: "no"
                - settings/max_server_memory_*: "no"
                - settings/max_*_to_drop: "no"
                - settings/max_concurrent_queries: "no"
                - settings/models_config: "no"
                - settings/user_defined_executable_functions_config: "no"
                - settings/logger/*: "no"
                - settings/macros/*: "no"
                - settings/remote_servers/*: "no"
                - settings/user_directories/*: "no"
                - zookeeper/*: "yes"
                - files/*.xml: "yes"
                - files/config.d/*.xml: "yes"
                - files/config.d/*dict*.xml: "no"
                - profiles/default/background_*_pool_size: "yes"
                - profiles/default/max_*_for_server: "yes"
            - version: 21.*
              rules:
                - settings/logger: "yes"
    access:
        scheme: auto
        secret:
            name: clickhouse-operator
            runtime:
                username: ""
                password: ""
                fetched: false
                error: ""
        port: 8123
        timeouts:
            connect: 1ns
            query: 4ns
    metrics:
        timeouts:
            collect: 9ns
template:
    chi:
        policy: ApplyOnNextReconcile
        path: templates.d
reconcile:
    runtime:
        reconcileCHIsThreadsNumber: 10
        reconcileShardsThreadsNumber: 5
        reconcileShardsMaxConcurrencyPercent: 50
        threadsNumber: 0
    statefulSet:
        create:
            onFailure: ignore
        update:
            timeout: 300
            pollInterval: 5
            onFailure: abort
    host:
        wait:
            exclude: "true"
            queries: "true"
            include: "false"
annotation:
    include: []
    exclude: []
label:
    include: []
    exclude: []
    appendScope: "no"
    runtime:
        appendScope: false
statefulSet:
    revisionHistoryLimit: 0
pod:
    terminationGracePeriod: 30
logger:
    logtostderr: "true"
    alsologtostderr: "false"
    v: "1"
    stderrthreshold: ""
    vmodule: ""
    log_backtrace_at: ""
watchNamespaces: []
chCommonConfigsPath: ""
chHostConfigsPath: ""
chUsersConfigsPath: ""
chiTemplatesPath: ""
statefulSetUpdateTimeout: 0
statefulSetUpdatePollPeriod: 0
onStatefulSetCreateFailureAction: ""
onStatefulSetUpdateFailureAction: ""
chConfigUserDefaultProfile: ""
chConfigUserDefaultQuota: ""
chConfigUserDefaultNetworksIP: []
chConfigUserDefaultPassword: '***'
chConfigNetworksHostRegexpTemplate: ""
chScheme: ""
chUsername: '***'
chPassword: '***'
chCredentialsSecretNamespace: ""
chCredentialsSecretName: ""
chPort: 0
logtostderr: ""
alsologtostderr: ""
v: ""
stderrthreshold: ""
vmodule: ""
log_backtrace_at: ""
reconcileThreadsNumber: 0
reconcileWaitExclude: false
reconcileWaitInclude: false
includeIntoPropagationAnnotations: []
excludeFromPropagationAnnotations: []
includeIntoPropagationLabels: []
excludeFromPropagationLabels: []
appendScopeLabels: ""
terminationGracePeriod: 0
revisionHistoryLimit: 0
I0611 06:09:24.775975       1 config_manager.go:131] getAllCRBasedConfigs():Looking for ClickHouseOperatorConfigurations in namespace 'test'.
I0611 06:09:24.778737       1 config_manager.go:414] Going to search for username/password in the secret 'test/clickhouse-operator'
I0611 06:09:24.779453       1 config_manager.go:431] Secret fetched: 'test/clickhouse-operator'
I0611 06:09:24.779462       1 config_manager.go:441] Password read from the secret: 'test/clickhouse-operator'
I0611 06:09:24.779466       1 config_manager.go:438] Username read from the secret: 'test/clickhouse-operator'
I0611 06:09:24.779468       1 config_manager.go:106] Unified CHOP config - with secret data fetched (but not post-processed yet):
I0611 06:09:24.780084       1 config_manager.go:107] 
runtime:
    configFilePath: /etc/clickhouse-operator/config.yaml
    configFolderPath: /etc/clickhouse-operator
    configCRNamespace: ""
    configCRName: ""
    configCRSources: []
    namespace: ""
watch:
    namespaces: []
clickhouse:
    configuration:
        file:
            path:
                common: config.d
                host: conf.d
                user: users.d
        user:
            default:
                profile: default
                quota: default
                networksIP:
                    - ::1
                    - 127.0.0.1
                password: '***'
        network:
            hostRegexpTemplate: (chi-{chi}-[^.]+\d+-\d+|clickhouse\-{chi})\.{namespace}\.svc\.cluster\.local$
    configurationRestartPolicy:
        rules:
            - version: '*'
              rules:
                - settings/*: "yes"
                - settings/access_control_path: "no"
                - settings/dictionaries_config: "no"
                - settings/max_server_memory_*: "no"
                - settings/max_*_to_drop: "no"
                - settings/max_concurrent_queries: "no"
                - settings/models_config: "no"
                - settings/user_defined_executable_functions_config: "no"
                - settings/logger/*: "no"
                - settings/macros/*: "no"
                - settings/remote_servers/*: "no"
                - settings/user_directories/*: "no"
                - zookeeper/*: "yes"
                - files/*.xml: "yes"
                - files/config.d/*.xml: "yes"
                - files/config.d/*dict*.xml: "no"
                - profiles/default/background_*_pool_size: "yes"
                - profiles/default/max_*_for_server: "yes"
            - version: 21.*
              rules:
                - settings/logger: "yes"
    access:
        scheme: auto
        secret:
            name: clickhouse-operator
            runtime:
                username: clickhouse_operator
                password: '***'
                fetched: true
                error: ""
        port: 8123
        timeouts:
            connect: 1ns
            query: 4ns
    metrics:
        timeouts:
            collect: 9ns
template:
    chi:
        policy: ApplyOnNextReconcile
        path: templates.d
reconcile:
    runtime:
        reconcileCHIsThreadsNumber: 10
        reconcileShardsThreadsNumber: 5
        reconcileShardsMaxConcurrencyPercent: 50
        threadsNumber: 0
    statefulSet:
        create:
            onFailure: ignore
        update:
            timeout: 300
            pollInterval: 5
            onFailure: abort
    host:
        wait:
            exclude: "true"
            queries: "true"
            include: "false"
annotation:
    include: []
    exclude: []
label:
    include: []
    exclude: []
    appendScope: "no"
    runtime:
        appendScope: false
statefulSet:
    revisionHistoryLimit: 0
pod:
    terminationGracePeriod: 30
logger:
    logtostderr: "true"
    alsologtostderr: "false"
    v: "1"
    stderrthreshold: ""
    vmodule: ""
    log_backtrace_at: ""
watchNamespaces: []
chCommonConfigsPath: ""
chHostConfigsPath: ""
chUsersConfigsPath: ""
chiTemplatesPath: ""
statefulSetUpdateTimeout: 0
statefulSetUpdatePollPeriod: 0
onStatefulSetCreateFailureAction: ""
onStatefulSetUpdateFailureAction: ""
chConfigUserDefaultProfile: ""
chConfigUserDefaultQuota: ""
chConfigUserDefaultNetworksIP: []
chConfigUserDefaultPassword: '***'
chConfigNetworksHostRegexpTemplate: ""
chScheme: ""
chUsername: '***'
chPassword: '***'
chCredentialsSecretNamespace: ""
chCredentialsSecretName: ""
chPort: 0
logtostderr: ""
alsologtostderr: ""
v: ""
stderrthreshold: ""
vmodule: ""
log_backtrace_at: ""
reconcileThreadsNumber: 0
reconcileWaitExclude: false
reconcileWaitInclude: false
includeIntoPropagationAnnotations: []
excludeFromPropagationAnnotations: []
includeIntoPropagationLabels: []
excludeFromPropagationLabels: []
appendScopeLabels: ""
terminationGracePeriod: 0
revisionHistoryLimit: 0
I0611 06:09:24.780239       1 config_manager.go:113] Final CHOP config:
I0611 06:09:24.780562       1 config_manager.go:114] 
runtime:
    configFilePath: /etc/clickhouse-operator/config.yaml
    configFolderPath: /etc/clickhouse-operator
    configCRNamespace: ""
    configCRName: ""
    configCRSources: []
    namespace: test
watch:
    namespaces:
        - test
clickhouse:
    configuration:
        file:
            path:
                common: /etc/clickhouse-operator/config.d
                host: /etc/clickhouse-operator/conf.d
                user: /etc/clickhouse-operator/users.d
            runtime:
                commonConfigFiles:
                    01-clickhouse-01-listen.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <!-- Listen wildcard address to allow accepting connections from other containers and host network. -->
                            <listen_host>::</listen_host>
                            <listen_host>0.0.0.0</listen_host>
                            <listen_try>1</listen_try>
                            <background_buffer_flush_schedule_pool_size>16</background_buffer_flush_schedule_pool_size>
                            <background_pool_size>16</background_pool_size>
                            <background_schedule_pool_size>128</background_schedule_pool_size>
                        </yandex>
                    01-clickhouse-02-logger.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <logger>
                                <!-- Possible levels: https://github.com/pocoproject/poco/blob/devel/Foundation/include/Poco/Logger.h#L439 -->
                                <level>debug</level>
                                <log>/var/log/clickhouse-server/clickhouse-server.log</log>
                                <errorlog>/var/log/clickhouse-server/clickhouse-server.err.log</errorlog>
                                <size>1000M</size>
                                <count>10</count>
                                <!-- Default behavior is autodetection (log to console if not daemon mode and is tty) -->
                                <console>1</console>
                            </logger>
                        </yandex>
                    01-clickhouse-03-query_log.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <query_log replace="1">
                                <database>system</database>
                                <table>query_log</table>
                                <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>
                                <flush_interval_milliseconds>7500</flush_interval_milliseconds>
                            </query_log>
                            <query_thread_log remove="1"/>
                        </yandex>
                    01-clickhouse-04-part_log.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <part_log replace="1">
                                <database>system</database>
                                <table>part_log</table>
                                <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>
                                <flush_interval_milliseconds>7500</flush_interval_milliseconds>
                            </part_log>
                        </yandex>
                    01-clickhouse-05-trace_log.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <trace_log replace="1">
                                <database>system</database>
                                <table>trace_log</table>
                                <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>
                                <flush_interval_milliseconds>7500</flush_interval_milliseconds>
                            </trace_log>
                        </yandex>
                usersConfigFiles:
                    01-clickhouse-operator-profile.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <!--
                        #
                        # Template parameters available:
                        #
                        -->
                        <yandex>
                            <!-- clickhouse-operator user is generated by the operator based on config.yaml in runtime -->
                            <profiles>
                                <clickhouse_operator>
                                    <log_queries>0</log_queries>
                                    <skip_unavailable_shards>1</skip_unavailable_shards>
                                    <http_connection_timeout>10</http_connection_timeout>
                                    <max_concurrent_queries_for_all_users>0</max_concurrent_queries_for_all_users>
                                    <os_thread_priority>0</os_thread_priority>
                                </clickhouse_operator>
                            </profiles>
                        </yandex>
                    02-clickhouse-default-profile.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                          <profiles>
                            <default>
                              <os_thread_priority>2</os_thread_priority>
                              <log_queries>1</log_queries>
                              <connect_timeout_with_failover_ms>1000</connect_timeout_with_failover_ms>
                              <distributed_aggregation_memory_efficient>1</distributed_aggregation_memory_efficient>
                              <parallel_view_processing>1</parallel_view_processing>
                              <do_not_merge_across_partitions_select_final>1</do_not_merge_across_partitions_select_final>
                              <load_balancing>nearest_hostname</load_balancing>
                              <prefer_localhost_replica>0</prefer_localhost_replica>
                              <!-- materialize_ttl_recalculate_only>1</materialize_ttl_recalculate_only> 21.10 and above -->
                            </default>
                          </profiles>
                        </yandex>
        user:
            default:
                profile: default
                quota: default
                networksIP:
                    - ::1
                    - 127.0.0.1
                password: '***'
        network:
            hostRegexpTemplate: (chi-{chi}-[^.]+\d+-\d+|clickhouse\-{chi})\.{namespace}\.svc\.cluster\.local$
    configurationRestartPolicy:
        rules:
            - version: '*'
              rules:
                - settings/*: "yes"
                - settings/access_control_path: "no"
                - settings/dictionaries_config: "no"
                - settings/max_server_memory_*: "no"
                - settings/max_*_to_drop: "no"
                - settings/max_concurrent_queries: "no"
                - settings/models_config: "no"
                - settings/user_defined_executable_functions_config: "no"
                - settings/logger/*: "no"
                - settings/macros/*: "no"
                - settings/remote_servers/*: "no"
                - settings/user_directories/*: "no"
                - zookeeper/*: "yes"
                - files/*.xml: "yes"
                - files/config.d/*.xml: "yes"
                - files/config.d/*dict*.xml: "no"
                - profiles/default/background_*_pool_size: "yes"
                - profiles/default/max_*_for_server: "yes"
            - version: 21.*
              rules:
                - settings/logger: "yes"
    access:
        scheme: auto
        username: clickhouse_operator
        password: '***'
        secret:
            name: clickhouse-operator
            runtime:
                username: clickhouse_operator
                password: '***'
                fetched: true
                error: ""
        port: 8123
        timeouts:
            connect: 1s
            query: 4s
    metrics:
        timeouts:
            collect: 9s
template:
    chi:
        policy: ApplyOnNextReconcile
        path: /etc/clickhouse-operator/templates.d
reconcile:
    runtime:
        reconcileCHIsThreadsNumber: 10
        reconcileShardsThreadsNumber: 5
        reconcileShardsMaxConcurrencyPercent: 50
        threadsNumber: 1
    statefulSet:
        create:
            onFailure: ignore
        update:
            timeout: 300
            pollInterval: 5
            onFailure: abort
    host:
        wait:
            exclude: "true"
            queries: "true"
            include: "false"
annotation:
    include: []
    exclude: []
label:
    include: []
    exclude: []
    appendScope: "no"
    runtime:
        appendScope: false
statefulSet:
    revisionHistoryLimit: 10
pod:
    terminationGracePeriod: 30
logger:
    logtostderr: "true"
    alsologtostderr: "false"
    v: "1"
    stderrthreshold: ""
    vmodule: ""
    log_backtrace_at: ""
watchNamespaces: []
chCommonConfigsPath: ""
chHostConfigsPath: ""
chUsersConfigsPath: ""
chiTemplatesPath: ""
statefulSetUpdateTimeout: 0
statefulSetUpdatePollPeriod: 0
onStatefulSetCreateFailureAction: ""
onStatefulSetUpdateFailureAction: ""
chConfigUserDefaultProfile: ""
chConfigUserDefaultQuota: ""
chConfigUserDefaultNetworksIP: []
chConfigUserDefaultPassword: '***'
chConfigNetworksHostRegexpTemplate: ""
chScheme: ""
chUsername: '***'
chPassword: '***'
chCredentialsSecretNamespace: ""
chCredentialsSecretName: ""
chPort: 0
logtostderr: ""
alsologtostderr: ""
v: ""
stderrthreshold: ""
vmodule: ""
log_backtrace_at: ""
reconcileThreadsNumber: 0
reconcileWaitExclude: false
reconcileWaitInclude: false
includeIntoPropagationAnnotations: []
excludeFromPropagationAnnotations: []
includeIntoPropagationLabels: []
excludeFromPropagationLabels: []
appendScopeLabels: ""
terminationGracePeriod: 0
revisionHistoryLimit: 0
I0611 06:09:24.780576       1 chop.go:104] Log option 'logtostderr' change value from 'true' to 'true'
I0611 06:09:24.780582       1 chop.go:104] Log option 'alsologtostderr' change value from 'false' to 'false'
I0611 06:09:24.780584       1 chop.go:104] Log option 'v' change value from '1' to '1'
I0611 06:09:24.780588       1 chop.go:98] Additional log options applied
I0611 06:09:24.780906       1 metrics_exporter.go:97] runtime:
    configFilePath: /etc/clickhouse-operator/config.yaml
    configFolderPath: /etc/clickhouse-operator
    configCRNamespace: ""
    configCRName: ""
    configCRSources: []
    namespace: test
watch:
    namespaces:
        - test
clickhouse:
    configuration:
        file:
            path:
                common: /etc/clickhouse-operator/config.d
                host: /etc/clickhouse-operator/conf.d
                user: /etc/clickhouse-operator/users.d
            runtime:
                commonConfigFiles:
                    01-clickhouse-01-listen.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <!-- Listen wildcard address to allow accepting connections from other containers and host network. -->
                            <listen_host>::</listen_host>
                            <listen_host>0.0.0.0</listen_host>
                            <listen_try>1</listen_try>
                            <background_buffer_flush_schedule_pool_size>16</background_buffer_flush_schedule_pool_size>
                            <background_pool_size>16</background_pool_size>
                            <background_schedule_pool_size>128</background_schedule_pool_size>
                        </yandex>
                    01-clickhouse-02-logger.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <logger>
                                <!-- Possible levels: https://github.com/pocoproject/poco/blob/devel/Foundation/include/Poco/Logger.h#L439 -->
                                <level>debug</level>
                                <log>/var/log/clickhouse-server/clickhouse-server.log</log>
                                <errorlog>/var/log/clickhouse-server/clickhouse-server.err.log</errorlog>
                                <size>1000M</size>
                                <count>10</count>
                                <!-- Default behavior is autodetection (log to console if not daemon mode and is tty) -->
                                <console>1</console>
                            </logger>
                        </yandex>
                    01-clickhouse-03-query_log.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <query_log replace="1">
                                <database>system</database>
                                <table>query_log</table>
                                <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>
                                <flush_interval_milliseconds>7500</flush_interval_milliseconds>
                            </query_log>
                            <query_thread_log remove="1"/>
                        </yandex>
                    01-clickhouse-04-part_log.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <part_log replace="1">
                                <database>system</database>
                                <table>part_log</table>
                                <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>
                                <flush_interval_milliseconds>7500</flush_interval_milliseconds>
                            </part_log>
                        </yandex>
                    01-clickhouse-05-trace_log.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                            <trace_log replace="1">
                                <database>system</database>
                                <table>trace_log</table>
                                <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>
                                <flush_interval_milliseconds>7500</flush_interval_milliseconds>
                            </trace_log>
                        </yandex>
                usersConfigFiles:
                    01-clickhouse-operator-profile.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <!--
                        #
                        # Template parameters available:
                        #
                        -->
                        <yandex>
                            <!-- clickhouse-operator user is generated by the operator based on config.yaml in runtime -->
                            <profiles>
                                <clickhouse_operator>
                                    <log_queries>0</log_queries>
                                    <skip_unavailable_shards>1</skip_unavailable_shards>
                                    <http_connection_timeout>10</http_connection_timeout>
                                    <max_concurrent_queries_for_all_users>0</max_concurrent_queries_for_all_users>
                                    <os_thread_priority>0</os_thread_priority>
                                </clickhouse_operator>
                            </profiles>
                        </yandex>
                    02-clickhouse-default-profile.xml: |
                        <!-- IMPORTANT -->
                        <!-- This file is auto-generated -->
                        <!-- Do not edit this file - all changes would be lost -->
                        <!-- Edit appropriate template in the following folder: -->
                        <!-- deploy/builder/templates-config -->
                        <!-- IMPORTANT -->
                        <yandex>
                          <profiles>
                            <default>
                              <os_thread_priority>2</os_thread_priority>
                              <log_queries>1</log_queries>
                              <connect_timeout_with_failover_ms>1000</connect_timeout_with_failover_ms>
                              <distributed_aggregation_memory_efficient>1</distributed_aggregation_memory_efficient>
                              <parallel_view_processing>1</parallel_view_processing>
                              <do_not_merge_across_partitions_select_final>1</do_not_merge_across_partitions_select_final>
                              <load_balancing>nearest_hostname</load_balancing>
                              <prefer_localhost_replica>0</prefer_localhost_replica>
                              <!-- materialize_ttl_recalculate_only>1</materialize_ttl_recalculate_only> 21.10 and above -->
                            </default>
                          </profiles>
                        </yandex>
        user:
            default:
                profile: default
                quota: default
                networksIP:
                    - ::1
                    - 127.0.0.1
                password: '***'
        network:
            hostRegexpTemplate: (chi-{chi}-[^.]+\d+-\d+|clickhouse\-{chi})\.{namespace}\.svc\.cluster\.local$
    configurationRestartPolicy:
        rules:
            - version: '*'
              rules:
                - settings/*: "yes"
                - settings/access_control_path: "no"
                - settings/dictionaries_config: "no"
                - settings/max_server_memory_*: "no"
                - settings/max_*_to_drop: "no"
                - settings/max_concurrent_queries: "no"
                - settings/models_config: "no"
                - settings/user_defined_executable_functions_config: "no"
                - settings/logger/*: "no"
                - settings/macros/*: "no"
                - settings/remote_servers/*: "no"
                - settings/user_directories/*: "no"
                - zookeeper/*: "yes"
                - files/*.xml: "yes"
                - files/config.d/*.xml: "yes"
                - files/config.d/*dict*.xml: "no"
                - profiles/default/background_*_pool_size: "yes"
                - profiles/default/max_*_for_server: "yes"
            - version: 21.*
              rules:
                - settings/logger: "yes"
    access:
        scheme: auto
        username: clickhouse_operator
        password: '***'
        secret:
            name: clickhouse-operator
            runtime:
                username: clickhouse_operator
                password: '***'
                fetched: true
                error: ""
        port: 8123
        timeouts:
            connect: 1s
            query: 4s
    metrics:
        timeouts:
            collect: 9s
template:
    chi:
        policy: ApplyOnNextReconcile
        path: /etc/clickhouse-operator/templates.d
reconcile:
    runtime:
        reconcileCHIsThreadsNumber: 10
        reconcileShardsThreadsNumber: 5
        reconcileShardsMaxConcurrencyPercent: 50
        threadsNumber: 1
    statefulSet:
        create:
            onFailure: ignore
        update:
            timeout: 300
            pollInterval: 5
            onFailure: abort
    host:
        wait:
            exclude: "true"
            queries: "true"
            include: "false"
annotation:
    include: []
    exclude: []
label:
    include: []
    exclude: []
    appendScope: "no"
    runtime:
        appendScope: false
statefulSet:
    revisionHistoryLimit: 10
pod:
    terminationGracePeriod: 30
logger:
    logtostderr: "true"
    alsologtostderr: "false"
    v: "1"
    stderrthreshold: ""
    vmodule: ""
    log_backtrace_at: ""
watchNamespaces: []
chCommonConfigsPath: ""
chHostConfigsPath: ""
chUsersConfigsPath: ""
chiTemplatesPath: ""
statefulSetUpdateTimeout: 0
statefulSetUpdatePollPeriod: 0
onStatefulSetCreateFailureAction: ""
onStatefulSetUpdateFailureAction: ""
chConfigUserDefaultProfile: ""
chConfigUserDefaultQuota: ""
chConfigUserDefaultNetworksIP: []
chConfigUserDefaultPassword: '***'
chConfigNetworksHostRegexpTemplate: ""
chScheme: ""
chUsername: '***'
chPassword: '***'
chCredentialsSecretNamespace: ""
chCredentialsSecretName: ""
chPort: 0
logtostderr: ""
alsologtostderr: ""
v: ""
stderrthreshold: ""
vmodule: ""
log_backtrace_at: ""
reconcileThreadsNumber: 0
reconcileWaitExclude: false
reconcileWaitInclude: false
includeIntoPropagationAnnotations: []
excludeFromPropagationAnnotations: []
includeIntoPropagationLabels: []
excludeFromPropagationLabels: []
appendScopeLabels: ""
terminationGracePeriod: 0
revisionHistoryLimit: 0
I0611 06:09:24.780915       1 rest_server.go:37] Starting metrics exporter at ':8888/metrics'
I0611 06:09:24.780939       1 exporter.go:78] Collect started
I0611 06:09:24.780949       1 exporter.go:91] Launching host collectors [12.5µs]
I0611 06:09:24.780958       1 exporter.go:80] Collect completed [22.417µs]
I0611 06:09:56.284448       1 exporter.go:142] Update ClickHouseInstallation (test/test-001): {"namespace":"test","name":"test-001","labels":null,"annotations":{},"clusters":[{"name":"single","hosts":[{"name":"0-0","hostname":"chi-test-001-single-0-0.test.svc.cluster.local","tcpPort":9000,"httpPort":8123}]}]}
